\documentclass{article}

\begin{document}

\title{SNEWS Operational Mode \#1 effective 1/11/2003}         
\author{SNEWS Collaboration}
\date{\today}
\maketitle

\section{Participating Experiments}

The participating experiments for this mode are:

\begin{itemize}
\item Super-K,
\item LVD,
\item SNO.
\end{itemize}

\section{Client Computer Management}

The following are recommended:

\begin{itemize}
\item TCP/IP access should be restricted outside the main domain of the 
client Computer.
\item Login should permitted only to SNEWS subgroup members.
\item The TCP/IP address of client computer should be known only to SNEWS subgroup members.
\item The full datagram structure should be known only to SNEWS subgroup members.
\item .. anything else..
\end{itemize}
Most part of the preceding recommendations are already effective.

\section{Server Computer Management}

In this mode of operation, there is one server located at Brookhaven
National Laboratory, and the BNL SNEWS sysadmin is Brett Viren.
The details of the server management, addressing all
security and maintenance issues, can be found at
in the Memorandum of Understanding at
{\tt http://cyclo.mit.edu/snnet/bnl\_mou}.

\section{Client-Server Communications}\label{alarm}
\begin{itemize}
\item Each participating experiment may generate and send to the server
3 different types of alarm defined as TEST or BAD or GOOD and 
properly flagged in the datagram.({\it The type name may be conveniently 
changed as well as the flag number for the coincidence code.})
\begin{itemize}
\item TEST: This code has to be used only to check the client-server
connection. The datagram structure is fixed: all parameters in the
datagram, different from flag and
experiment code, must be set to {\it 0}. Alarm flag is set to {\it 0}. 

\item BAD : This code flags alarms generated when scheduled operations
(i.e. maintenance, calibration, tests, etc.) on the detector are going on. It's
up to each experiment to set this flag inside the packet when it's supposed
necessary. 
All parameters in the datagram should be properly filled according
to the time of the event and the experiment code. Alarm flag is set to 
{\it 1}.

\item GOOD: This code flags alarms generated in normal detection conditions.
All parameters in the datagram should be properly filled according
to the time of the event and the experiment code. Alarm flag is set to 
{\it 2}.
\end{itemize}
 

\item The client datagrams employ TCP protocol and 
are encrypted using OpenSSL.  
The server listens for connections on a specified port,
and when a client initiates a connection, several layers
of checks are employed:
\begin{enumerate}
\item The server employs a {\it tcp\_wrappers hosts\_access}
call to check the IP of the client machine against the lists in
{\it hosts.allow/deny}.  These lists allow only the IP addresses
of the client machines of the involved experiments.
\item
The client and server exchange certificates which have been
verified by the SNEWS Certificate Authority, and reject
connections if the check fails.
\item There is an additional check of specific client machine
IP addresses before data is exchanged.
\end{enumerate}
\end{itemize}

\section{SNEWS Shift}

SNEWS shifts will be coordinated by xxx, and will be run on
a week by week basis.  During each shift week, the shifter will
be equipped with a cell phone and laptop with cellular
capabibility. A short and simple to use manual on shifter's 
responsibilities will be provided. Daily duties, alert procedures and
actions, e-mail and phone numbers of all subgroup members, SNEWS
coordinator, server manager should be included.

\subsection{Alert Responsibilities}

% More details on alert
Upon receipt of coincidence, either SILVER or GOLD, the shifter
must immediately log on to check that SNEWS code is running
correctly, according to logs.  If everything seems OK, for 
the case of a SILVER-GOLD  alert, he or she must follow the procedure
outlined in sections \ref{SILVER}-\ref{GOLD}.
({\it If something seems to be wrong, whatever the alert is, the consequent  
actions for the shifter must be here defined.})

\subsection{Maintenance and Monitoring Responsibilities}

At daily intervals, the shifter must check the following:

\begin{itemize}
\item The gcserver process is running normally.
\item That there is network connectivity to all clients. ({\it may
require communication })
\item ping plots... other checks...

\end{itemize}

The shifter must confirm in the online logbook, record any
anomalous conditions, and, if there, notify the rest of the subgroup.

% Backup shifter?


\section{Coincidence Definition}

The general coincidence definition implemented in the coincidence code
may generate two types of alert:GOLD and SILVER.\\
A GOLD alert is generated if {\it all} of
following conditions (1 through 4) are met:

\begin{enumerate}

\item There is a 2 or more -fold coincidence within 10 seconds,
involving at least two different experiments. 
(The time window refers to the maximum
separation of any of the alarms in the coincidence.)

\item At least two of the experiments involved
are at different laboratories.

\item Two or more of the alarms in the coincidence
are flagged as GOOD.  The SNEWS collaboration states
that flagging the alarms as GOOD or BAD (eventually TEST) should be effective 
for all detectors when in the operational  mode.  
It's up to each participant to flag properly the alarm sent to the SNEWS 
server(s). 
The specific criteria for a GOOD/BAD/TEST alarm are locally defined by
each experiment according to the general rule defined in section \ref{alarm}. 
  
 \item For at least two of the experiments involved in the coincidence,
the rate of good alarms for several past time intervals $\{T_i\}=\{$10 minutes, 1
hour, 10 hours, 1 day, 3 days, 1 week, 1 month$\}$, must be consistent with
the $\lambda_{\rm{max}}=$1/week requirement.\footnote{These intervals
represent real time, not live time, since full live time information
will not be available to the coincidence server.}
We define the precise condition 
as follows:  
if an experiment sent $\{n_i\}$ alarms in 
each of the last intervals $\{T_i\}$,
then the Poisson probabilities $\mathcal{P}_i$ for $n_i$ or more
alarms in $T_i$,

$\mathcal{P}_i=\sum_{n=n_i}^{\infty}(\lambda_{\rm{max}} T_i)^{n}e^{-\lambda_{\rm{max}} T_i}/n!$,

for each interval $T_i$, must each be greater than $\mathcal{P}_{thr}=0.5$\%.
This corresponds to the condition that each $\{n_i\}$ must be be less
than $\{1,2,2,3,4,5,11\}$ for the preceding intervals $\{T_i\}$ for an
alarm to be GOLD.

\end{enumerate}

When at least the first criterion is satisfied the generated alert is
flagged as SILVER. In this case the consistency and the reliability 
of the alert has to be checked by the experimenters inside the collaboration before any public announcement. No alert will be sent by SNEWS until (and if)
there is an upgrade to GOLD.

\section{Alert Procedure}
({\it This is a very important section. We are fixing the way to procede
in the case of a coincidence. Please read carefully and add any 
comments/modifications/suggestions you think are useful. These are 
just the first ideas on. In some case  only the philosphy on what we need 
to do is specified with no technical solutions yet.}\\

\subsection{General Considerations}

Whichever the automated generated alert is -GOLD or SILVER- the
general approved procedure here enclosed will be strictly applied. In
the same context, any public release by SNEWS collaboration and by the
individual experiment collaborations, if a SNEWS alert is involved,
will be according to the general policies defined here.\\


All relevant parameters {\it -UTC
time of the coincidence, involved detectors, type of alarms-} will be
automatically forwarded by the server(s) to the SNEWS subgroup members
at the time of the dispatched alert, either SILVER or GOLD.
After receipt of this information, if under any condition,
the coincidence and the number of detectors which generate 
it is used either for any scientific purpose or for any alert
communication, the SNEWS origin of these informations
should be always clearly cited.

({\it Should we post on-line the information in to a 
restricted WEB page on the server? May be useful in the case e-mail is not available. 
However the snnet web page should report the cronology of what has been going on.})

% Perhaps put this in the template
For each alert type, each experimental collaboration 
provides a list of e-mails, names and phone numbers, and fixes
the specific
notification order and procedure. For instance, an email may
be sent to a particular list, and furthermore a certain set of
people may be notified in a given order by the SNEWS shifter.

It is up to each experiment's members to check
its own data quality and forward to the SNEWS subgroup any information
which may affect the alert type in upgrading or demoting it as well to
resend the datagram to the server(s).  To avoid misunderstanding, the
UTC time of a re-forwarded alarm must be preserved.
 
Specific procedures for GOLD and SILVER alert and consequent actions 
will now be discussed.

({\it Question: what's the current time limit to regenerate the coincidence?
How long do we wait? We need to define this to avoid retraction after long 
time. If another server will be on-line we have to fix some priority between 
them, ore we can have a double notification.
})

\subsection{GOLD Procedure}\label{GOLD}

In the case of a GOLD alert all SNEWS subgroup members must be informed
on-line at the time of the automated alert is sent to the astronomical
community.
Any outcoming, private or public, communication of each experiment following 
this moment should always 
mention the presence of the GOLD alert, possibly with all public informations
therein contained.\\

{\bf Demoting from GOLD to SILVER}\\ Any Experiment can individually
reflag from GOOD to BAD its own alarm after data checking and must
proceed as expected by the above general policies.  Doing this, the
possibility of an automated retraction procedure for a GOLD alert is
taken into account and it must be effective within one day to be
processed by the server(s). In this case all SNEWS subgroup
members as well as the Astro-Community must be immediately notified in
the same way used to send the GOLD-type. The presence of a lower
significance alert should still be included.({\it Does everyone agree
on this point? -> this time limit will already be enforced as
the software is currently set up-- alerts are kept only for a day
and then thrown away})

\subsection{SILVER Procedure}\label{SILVER}
No automated alert is generated by the coincidence server(s). 
The SNEWS subgroup members are immediately notified by the shifter 
with all informations needed for the prompt check of the data in order to 
confirm or reject it definitely.
The procedure indicated by each experiment should be followed.\\


\textbf{Upgrading from SILVER to GOLD}\\
A SILVER alert may be upgraded to GOLD if the requirements are
confirmed in a second step. Any individual Experiment is expected to
resend its alarm datagram if the flag must be changed from BAD to
GOOD. All subgroup members must be informed at the same time by
e-mail. If the GOLD conditions are consequently fulfilled after the
new alarm dispatch, the GOLD procedure will automatically operate.

\subsection{Final Agreements}

The SNEWS collaboration agrees that all server(s)-clients information
exchanged during a supposed SN alert will be saved both on the web page
and the server(s) log file. All these informations will be available
for all subgroup members at time of the event and after. They will be
released on request to the SNEWS collaboration members 24 (?) hours
after the event.  ({\it 24 hours may be a too long time?})  There's no
restriction for any subgroup member to forward the informations above
inside the SNEWS collaboration 24 (?) hours after the event.


\section{Communication to the Scientific Community}
There is no restriction on invidual experiments announcing something
based on individual observation in the case on absence of a SNEWS
alert, SILVER or GOLD, or preceding it.  Any individual experiment may
publicly announce supposed supernova signal following a dispatched 
SILVER alert which has not yet been upgraded to GOLD.  In this case 
the information that a previous SILVER alert from the
SNEWS server(s) has been received should be cited.
                                         
\subsection{Privacy Agreement}
                                     

\end{document}
